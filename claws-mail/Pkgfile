# Description: An e-mail client (and news reader), based on GTK+
# URL: https://www.claws-mail.org
# Maintainer: Tim Biermann, tbier at posteo dot de
# Depends on: gtk libetpan gpgme gnutls libical networkmanager

name=claws-mail
version=3.17.4
release=3
source=(https://www.claws-mail.org/releases/$name-$version.tar.xz
  claws-mail-3.17.4-libetpan_pkgconfig.patch)

build() {
  cd $name-$version
  patch -Np1 -i $SRC/claws-mail-3.17.4-libetpan_pkgconfig.patch
  autoreconf
  ./configure \
      --prefix=/usr \
      --enable-gnutls \
      --enable-alternate-addressbook \
      --with-config-dir=.config/claws-mail \
      --disable-manual \
      --disable-static \
      --disable-nls \
      --disable-maintainer-mode \
      --disable-valgrind

  sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool

  make
  make DESTDIR=$PKG install

  rm -rf $PKG/usr/share/doc
}
