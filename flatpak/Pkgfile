# Description: Linux application sandboxing and distribution framework (formerly xdg-app)
# URL: http://flatpak.org
# Maintainer: Tim Biermann, tbier at posteo dot de
# Depends on: appstream-glib json-glib libseccomp ostree bubblewrap polkit xdg-desktop-portal

name=flatpak
version=1.1.3
release=2
source=(https://github.com/flatpak/flatpak/releases/download/$version/$name-$version.tar.xz)

build() {
	cd $name-$version

	./configure \
		--prefix=/usr \
		--disable-static \
		--enable-p2p \
        --with-system-bubblewrap \
		--with-priv-mode=setuid \
        --with-profile-dir=/etc/profile.d \
        --with-dbus-config-dir=/usr/etc/dbus-1/system.d \
        --disable-nls

	sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool

	make
	make DESTDIR=$PKG install

    rm -fr $PKG/usr/lib/systemd
    rm -fr $PKG/usr/share/gtk-doc
}
