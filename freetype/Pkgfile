# Description: A free and portable TrueType font rendering engine
# URL: http://www.freetype.org
# Maintainer: Fredrik Rinnestam, fredrik at crux dot nu
# Depends on: libpng

name=freetype
version=2.9
release=1
source=(http://download.savannah.gnu.org/releases/$name/$name-$version.tar.bz2
0001-Enable-table-validation-modules.patch
0001-psaux-Correctly-handle-Flex-features-52846.patch
0002-Enable-infinality-subpixel-hinting.patch
0003-Enable-long-PCF-family-names.patch
0007-cleartype.patch
)

build() {
    cd freetype-$version
    
  patch -Np1 -i ../0001-Enable-table-validation-modules.patch
  patch -Np1 -i ../0002-Enable-infinality-subpixel-hinting.patch
  patch -Np1 -i ../0003-Enable-long-PCF-family-names.patch
  patch -Np0 -i ../0007-cleartype.patch

  # Freetype 2.9 regression: bad rendering for some Type 1 fonts
  # https://savannah.nongnu.org/bugs/?52846
  patch -Np1 -i ../0001-psaux-Correctly-handle-Flex-features-52846.patch
    

    ./configure --prefix=/usr \
                --with-zlib

    make
    make DESTDIR=$PKG install
}
